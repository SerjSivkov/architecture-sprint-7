## Задание 1. Разработка проверочного листа по безопасности данных

Классификация типов данных для системы PropDevelopment указана в [файле](Exc1/ANALYZE.md).

Риски данных и их оценки указаны в [mindmap](Exc1/mindmap.drawio)

## Задание 2. Разработка и заполнение проверочного листа для бизнес-систем

Анализ схемы и описание системы выполнено в [файле](Exc2/ANALYZE.md).

Проверочный лист доступен в [таблице](Exc2/checklist.xlsx)

## Задание 3. Внешние интеграции

Диаграмма контекста в модели C4 [в файле](Exc3/PropDevelopment_С4_model-context.drawio). Она отражает только контекст новой интеграции.

Обновленная диаграмма C4 и пояснения доступны [тут](Exc3/PropDevelopment_С4_model.drawio).


### Список требований

Зоны ответственности - поставщик услуг занимается хранением конфиденциальных данных в виде биометрии и номеров автомобилей, чтобы у нас не добавлялась необходимость повышать уровень защиты из-за наличия биометрических данных.

Взаимодействие с поставщиком интеллектуальных услуг производим через отдельный API Gateway, который будет производить фильтрацию данных (чтобы передавать в обе стороны только то, что не несет лишних рисков), а также позволит построить логирование и мониторинг конкретно этой интеграции. Изменения сервиса и деплой будут происходить только с аппрува ИБ, а работа с внешним сервисом будет возможна только с этого api gateway (если подключиться с ai-app напрямую - поставщик не ответит), это позволит защититься от рисков что разработчики используют апи напрямую и читают/пишут данные которые не должны читать/писать и видеть в целом.

При передаче данных используем TLS шифрование, с обязательной защитой от MITM атак через SSL Pining и при работе со стороны нашего приложения и со стороны работы нашего сервера с внешней системой.

На стороне поставщика можно вести список белых IP наших обращений, если приходит запрос с токенами нашей системы, но не с IP, которого нет в списке, запрос блокируется.
Либо можно для общения с поставщиком сделать частную сеть VPN.

## Задание 4. Защита доступа к кластеру Kubernetes

Описание ролей, групп и их полномочий в [таблице](Exc4/роли_и_группы_и_их_полномочия.xlsx).

Запуск minikube:
```
minikube start --vm-driver=docker
```

Выполнение скриптов:
```
./configure_kube.sh
```

Проверка корректности настройки выполняется командой:
```
./check_user_access.sh
```
## Задание 5. Управление трафиком внутри кластера Kubertnetes

### Настройка Kubertnetes

1. Стартуем minikube с calico (т.к. NetworkPolicy не работают в дефолтном minikube):
```
minikube start --vm-driver=docker --cni calico
```
Если ранее был minikube - его надо удалить:
```
minikube delete
```

2. Настраиваем сеть:
```
kubectl apply -f non-admin-api-allow.yml
```

3. Создаем сервисы:
```
./create_services.sh
```

### Проверки политик

1. Коннектимся к тестовому поду:
```
kubectl run test-$RANDOM --rm -i -t --image=alpine -- wget -qO- --timeout=2 http://back-end-api-app 
```
Если пишет:
```
wget: download timed out
```
Значит доступа нет.

2. Коннектимся к поду фронта:
```
kubectl exec -it front-end-app -- curl http://back-end-api-app 
```
Доступ будет.

3. Коннектимся с админ фронта:
```
kubectl exec -it admin-front-end-app -- curl http://back-end-api-app 
```
Доступа не будет.

Все работает согласно выставленным политикам.

### Удаление равзернутых сервисов

Выполните команду:
```
./delete_services.sh
```
